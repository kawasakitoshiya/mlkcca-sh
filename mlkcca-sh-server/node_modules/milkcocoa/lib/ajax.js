function request(e,t,r,n,o,s,u){function i(e){if(u){var t="";e.on("data",function(e){t+=e}),e.on("end",function(){u(null,JSON.parse(t))})}}var a=t?https:http,p={hostname:r,port:n||(t?443:80),path:o,method:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}};if("GET"==e){var l=querystring.stringify(s),c=t?"https://":"http://";a.get(c+r+o+"?"+l,i).on("error",function(e){u(e)})}else{var d=a.request(p,i);d.setTimeout(5e3),d.on("timeout",function(){u&&u(new Error("timed out"),null),d.abort()}),d.on("error",function(e){u&&u(e,null)});var l=querystring.stringify(s);d.write(l),d.end()}}function requestBrowser(e,t,r,n,o,s,u){var i=querystring.stringify(s),a=(t?"https://":"http://")+r+":"+n+o;"GET"==e&&(a+="?"+i);var p=createCORSRequest(e,a);p.withCredentials=!0,p.onload=function(){decoded="";try{var e=JSON.parse(p.responseText);u(null,e)}catch(t){u(null,JSON.parse(p.responseText))}},p.onerror=function(){u(p.statusText||"unknown error")},p.setRequestHeader("Content-type","application/x-www-form-urlencoded"),p.send(i)}function createCORSRequest(e,t){var r=new XMLHttpRequest;return"withCredentials"in r?r.open(e,t,!0):"undefined"!=typeof XDomainRequest?(r=new XDomainRequest,r.open(e,t)):r=null,r}var http=require("http"),https=require("https"),querystring=require("querystring");module.exports="browser"!==process.title?{request:request}:{request:requestBrowser};